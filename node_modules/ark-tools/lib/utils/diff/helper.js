"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.downloadExcel = void 0;

var _json2xls = _interopRequireDefault(require("json2xls"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var s2ab = function s2ab(s) {
  var buf = new ArrayBuffer(s.length);
  var view = new Uint8Array(buf);

  for (var i = 0; i !== s.length; i += 1) {
    view[i] = s.charCodeAt(i) & 0xff;
  }

  return buf;
};

var downloadExcel = function downloadExcel(_ref) {
  var data = _ref.data,
      fileName = _ref.fileName;
  var json2xlsData = (0, _json2xls.default)(data);
  var csv = btoa(json2xlsData);
  var blob = new Blob([s2ab(atob(csv))], {
    type: ""
  });

  if (window.navigator && window.navigator.msSaveOrOpenBlob) {
    window.navigator.msSaveOrOpenBlob(blob, "".concat(fileName, ".xlsx"));
  } else {
    var a = document.createElement("a");
    a.href = window.URL.createObjectURL(blob);
    a.download = "".concat(fileName, ".xlsx");
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  return true;
};

exports.downloadExcel = downloadExcel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9kaWZmL2hlbHBlci5qcyJdLCJuYW1lcyI6WyJzMmFiIiwicyIsImJ1ZiIsIkFycmF5QnVmZmVyIiwibGVuZ3RoIiwidmlldyIsIlVpbnQ4QXJyYXkiLCJpIiwiY2hhckNvZGVBdCIsImRvd25sb2FkRXhjZWwiLCJkYXRhIiwiZmlsZU5hbWUiLCJqc29uMnhsc0RhdGEiLCJjc3YiLCJidG9hIiwiYmxvYiIsIkJsb2IiLCJhdG9iIiwidHlwZSIsIndpbmRvdyIsIm5hdmlnYXRvciIsIm1zU2F2ZU9yT3BlbkJsb2IiLCJhIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaHJlZiIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImRvd25sb2FkIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJyZW1vdmVDaGlsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7O0FBRUEsSUFBTUEsSUFBSSxHQUFHLFNBQVBBLElBQU8sQ0FBQUMsQ0FBQyxFQUFJO0FBQ2hCLE1BQU1DLEdBQUcsR0FBRyxJQUFJQyxXQUFKLENBQWdCRixDQUFDLENBQUNHLE1BQWxCLENBQVo7QUFDQSxNQUFNQyxJQUFJLEdBQUcsSUFBSUMsVUFBSixDQUFlSixHQUFmLENBQWI7O0FBQ0EsT0FBSyxJQUFJSyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxLQUFLTixDQUFDLENBQUNHLE1BQXhCLEVBQWdDRyxDQUFDLElBQUksQ0FBckMsRUFBd0M7QUFDdENGLElBQUFBLElBQUksQ0FBQ0UsQ0FBRCxDQUFKLEdBQVVOLENBQUMsQ0FBQ08sVUFBRixDQUFhRCxDQUFiLElBQWtCLElBQTVCO0FBQ0Q7O0FBQ0QsU0FBT0wsR0FBUDtBQUNELENBUEQ7O0FBU08sSUFBTU8sYUFBYSxHQUFHLFNBQWhCQSxhQUFnQixPQUF3QjtBQUFBLE1BQXJCQyxJQUFxQixRQUFyQkEsSUFBcUI7QUFBQSxNQUFmQyxRQUFlLFFBQWZBLFFBQWU7QUFDbkQsTUFBTUMsWUFBWSxHQUFHLHVCQUFTRixJQUFULENBQXJCO0FBQ0EsTUFBTUcsR0FBRyxHQUFHQyxJQUFJLENBQUNGLFlBQUQsQ0FBaEI7QUFDQSxNQUFNRyxJQUFJLEdBQUcsSUFBSUMsSUFBSixDQUFTLENBQUNoQixJQUFJLENBQUNpQixJQUFJLENBQUNKLEdBQUQsQ0FBTCxDQUFMLENBQVQsRUFBNEI7QUFDdkNLLElBQUFBLElBQUksRUFBRTtBQURpQyxHQUE1QixDQUFiOztBQUdBLE1BQUlDLE1BQU0sQ0FBQ0MsU0FBUCxJQUFvQkQsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxnQkFBekMsRUFBMkQ7QUFDekRGLElBQUFBLE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsZ0JBQWpCLENBQWtDTixJQUFsQyxZQUEyQ0osUUFBM0M7QUFDRCxHQUZELE1BRU87QUFDTCxRQUFNVyxDQUFDLEdBQUdDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixHQUF2QixDQUFWO0FBQ0FGLElBQUFBLENBQUMsQ0FBQ0csSUFBRixHQUFTTixNQUFNLENBQUNPLEdBQVAsQ0FBV0MsZUFBWCxDQUEyQlosSUFBM0IsQ0FBVDtBQUNBTyxJQUFBQSxDQUFDLENBQUNNLFFBQUYsYUFBZ0JqQixRQUFoQjtBQUNBWSxJQUFBQSxRQUFRLENBQUNNLElBQVQsQ0FBY0MsV0FBZCxDQUEwQlIsQ0FBMUI7QUFDQUEsSUFBQUEsQ0FBQyxDQUFDUyxLQUFGO0FBQ0FSLElBQUFBLFFBQVEsQ0FBQ00sSUFBVCxDQUFjRyxXQUFkLENBQTBCVixDQUExQjtBQUNEOztBQUNELFNBQU8sSUFBUDtBQUNELENBakJNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGpzb24yeGxzIGZyb20gXCJqc29uMnhsc1wiO1xyXG5cclxuY29uc3QgczJhYiA9IHMgPT4ge1xyXG4gIGNvbnN0IGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcihzLmxlbmd0aCk7XHJcbiAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zik7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHMubGVuZ3RoOyBpICs9IDEpIHtcclxuICAgIHZpZXdbaV0gPSBzLmNoYXJDb2RlQXQoaSkgJiAweGZmO1xyXG4gIH1cclxuICByZXR1cm4gYnVmO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRvd25sb2FkRXhjZWwgPSAoeyBkYXRhLCBmaWxlTmFtZSB9KSA9PiB7XHJcbiAgY29uc3QganNvbjJ4bHNEYXRhID0ganNvbjJ4bHMoZGF0YSk7XHJcbiAgY29uc3QgY3N2ID0gYnRvYShqc29uMnhsc0RhdGEpO1xyXG4gIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbczJhYihhdG9iKGNzdikpXSwge1xyXG4gICAgdHlwZTogXCJcIlxyXG4gIH0pO1xyXG4gIGlmICh3aW5kb3cubmF2aWdhdG9yICYmIHdpbmRvdy5uYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYikge1xyXG4gICAgd2luZG93Lm5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKGJsb2IsIGAke2ZpbGVOYW1lfS54bHN4YCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcclxuICAgIGEuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgYS5kb3dubG9hZCA9IGAke2ZpbGVOYW1lfS54bHN4YDtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7XHJcbiAgICBhLmNsaWNrKCk7XHJcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpO1xyXG4gIH1cclxuICByZXR1cm4gdHJ1ZTtcclxufTtcclxuIl19